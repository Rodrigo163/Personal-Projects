"0","#first, dividing in waves"
"0","edges_w1 <- filter(edges, Wave==1)"
"0","edges_w2 <- filter(edges, Wave==2)"
"0","edges_w3 <- filter(edges, Wave==3)"
"0",""
"0","#getting a list of schools present in wave 1 and their IDs"
"0","school_ID_copyw1 <- filter(school_ID, ID %in% unique(ptable$School1) )"
"0","#now dividing by schools"
"0","#Each element of this list will be a list with the edges per school"
"0","edges_per_school_w1 <- list()"
"0",""
"0","#adding a zero to not have an empty list"
"0","for (i in 1:length(school_ID_copyw1$School)){"
"0","  edges_per_school_w1[[i]] <- c(0)"
"0","}"
"0","#looking for school of ID and recipient. If they both have schools and they match, add the edge to the corresponding list."
"0","for (i in 1:length(edges_w1$ID)){"
"0","   school.ID <- ptable$School1[which(ptable$ID == edges_w1$ID[i])]"
"0","   school.recipient <- ptable$School1[which(ptable$ID == edges_w1$Recipient[i])]"
"0","   if ((length(school.ID) != 0) && (length(school.recipient) != 0) && (school.ID == school.recipient)){"
"0","     sch <- which(school_ID_copyw1$ID == school.ID)"
"0","     edges_per_school_w1[[sch]] <- append(edges_per_school_w1[[sch]], list(c(edges_w1$ID[i], edges_w1$Recipient[i])))"
"0","   }"
"0","}"
"0",""
"0","#removing the 0"
"0","for (i in 1:length(school_ID_copyw1$School)){"
"0","  edges_per_school_w1[[i]] <- edges_per_school_w1[[i]][-1]"
"0","}"
"0",""
"0","#now creating a dataframe for each school"
"0","for (i in 1:31){"
"0","  school_name <- school_ID_copyw1$ID[i]"
"0","  aux1 <- vector()"
"0","  aux2 <- vector()"
"0","  for (j in 1:length(edges_per_school_w1[[i]])){"
"0","    aux1 <- c(aux1, toString(edges_per_school_w1[[i]][[j]][1]))"
"0","    aux2 <- c(aux2, toString(edges_per_school_w1[[i]][[j]][2]))"
"0","  }"
"0","  "
"0","  matrixaux <- matrix(c(aux1, aux2), ncol=2)"
"0","  "
"0","  file_name <- paste(""Wave1_"", school_name, sep='')"
"0","  network <- graph_from_edgelist(matrixaux, directed = TRUE)"
"0","  m <- as.data.frame(get.adjacency(network, sparse = FALSE))"
"0","  "
"0","  write.csv(m, paste('Y:/eco_redhead/LoRDIA/database/networks/',file_name,'.csv', sep=''), row.names = TRUE)"
"0","}"
"0","for (i in 33:33){"
"0","  school_name <- school_ID_copyw1$ID[i]"
"0","  aux1 <- vector()"
"0","  aux2 <- vector()"
"0","  for (j in 1:length(edges_per_school_w1[[i]])){"
"0","    aux1 <- c(aux1, toString(edges_per_school_w1[[1]][[j]][1]))"
"0","    aux2 <- c(aux2, toString(edges_per_school_w1[[1]][[j]][2]))"
"0","  }"
"0","  "
"0","  matrixaux <- matrix(c(aux1, aux2), ncol=2)"
"0","  "
"0","  file_name <- paste(""Wave1_"", school_name, sep='')"
"0","  network <- graph_from_edgelist(matrixaux, directed = TRUE)"
"0","  m <- as.data.frame(get.adjacency(network, sparse = FALSE))"
"0","  "
"0","  write.csv(m, paste('Y:/eco_redhead/LoRDIA/database/networks/',file_name,'.csv', sep=''), row.names = TRUE)"
"0","}"
"0",""
"0","#after doing this school by school we see that there are no edges going to school d7kv and that is why the program does not run properly for i=32. We skip that case."
"0",""
